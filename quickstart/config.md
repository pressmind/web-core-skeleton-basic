# Configuration options
The entire pressmind sdk has one config file.
By default, the config format is json, but it is also possible to use a php array or you can build your own config adapter.
During installation, the config file will be created and preconfigured based on the pressmind system. 

## What can I configure in the config file?
The following properties can be configured at that time:

* server
* database
* rest
* tmp_dir
* docs_dir
* logging
* debug
* data
* cache
* view_scripts
* scaffolder_templates
* file_handling
* image_handling
* scheduled_tasks

## Can the config be used for multiple stages?
Yes, based on environemt vars (development, testing, production) it is possible to
overwrite defined properties. 

## Properties

| property                                                                  | type                                      | example                                                                                | description                                                                                                                                                                                                                                                                                                                                                                                                             |
|---------------------------------------------------------------------------|-------------------------------------------|----------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| server.document_root                                                      | string                                    | BASE_PATH or /var/www/                                                                 | The base file path of the application (usually the directory that contains the document_root folder) <br> BASE_PATH is set as default (constant   is defined in bootstrap.php)                                                                                                                                                                                                                                          |
| server.web_server                                                         | enum                                      | Apache2                                                                                |                                                                                                                                                                                                                                                                                                                                                                                                                         |
| database.username                                                         | string                                    | root                                                                                   |                                                                                                                                                                                                                                                                                                                                                                                                                         |
| database.password                                                         | string                                    | root                                                                                   |                                                                                                                                                                                                                                                                                                                                                                                                                         |
| database.host                                                             | string                                    | 127.0.0.1                                                                              |                                                                                                                                                                                                                                                                                                                                                                                                                         |
| database.port                                                             | int                                       | 3306                                                                                   |                                                                                                                                                                                                                                                                                                                                                                                                                         |
| database.dbname                                                           | string                                    | pressmind-webcore                                                                      |                                                                                                                                                                                                                                                                                                                                                                                                                         |
| database.engine                                                           | enum(MySQL)                               | MySQL                                                                                  | other drivers like MySQL are not supported yet                                                                                                                                                                                                                                                                                                                                                                          |
| rest.client.api_endpoint                                                  | string                                    | https://api.pm-t2.com/v1.x/rest/                                                       | do not change this value, the endpoint is bound to the current   source                                                                                                                                                                                                                                                                                                                                                 |
| rest.client.api_key                                                       | string                                    | xxx                                                                                    |                                                                                                                                                                                                                                                                                                                                                                                                                         |
| rest.client.api_user                                                      | string                                    | xxx                                                                                    |                                                                                                                                                                                                                                                                                                                                                                                                                         |
| rest.client.api_password                                                  | string                                    | xxx                                                                                    |                                                                                                                                                                                                                                                                                                                                                                                                                         |
| rest.server.api_endpoint                                                  | string                                    | /rest                                                                                  | rest endpoint. Path must be relative to you're http webroot                                                                                                                                                                                                                                                                                                                   |
| rest.server.api_key                                                       | string                                    | abcd                                                                                   |                                                                                                                                                                                                                                                                                                                                                                                                                         |
| rest.server.api_user                                                      | string                                    | restuser                                                                               |                                                                                                                                                                                                                                                                                                                                                                                                                         |
| rest.server.api_password                                                  | string                                    | restpw                                                                                 |                                                                                                                                                                                                                                                                                                                                                                                                                         |
| tmp_dir                                                                   | dir                                       | APPLICATION_PATH/tmp                                                                   |                                                                                                                                                                                                                                                                                                                                                                                                                         |
| docs_dir                                                                  | dir                                       | APPLICATION_PATH/docs                                                                  | During installation we generate some html documentation files for each media object type, this files are stored in this place                                                                                                                                                                                                                                                                                         |
| logging.mode                                                              | enum(ALL, ERROR, WARNING, INFO)           | ALL                                                                                    | Loglevel
| logging.storage                                                           | enum(database, filesystem)                | database                                                                               | Set to 'database' if you need a stateless enviroment (e.g. kubernetes, docker setups).<br> Otherwise you can set the storage to 'file' which means, that logs are stored in the filesystem. <br>Be in mind that the automatic log cleanup is trigged by the cron.php.                                                                                                                                                                                                                                                                                                                                                                                                                        |
| logging.log_file_path                                                     | dir                                       | APPLICATION_PATH/logs                                                                  | Optional if storage is 'database'                                                                                                                                                                                                                                                                                                                                                                                       |
| logging.error_email_address                                               | email                                     | john.doe@local                                                                         | Not yet supported                                                                                                                                                                                                                                                                                                                                                                        |
| logging.lifetime                                                          | int                                       | 86400                                                                                  |                                                                                                                                                                                                                                                                                                                                                                                                                         |
| logging.keep_log_types                                                    | array                                     | ERROR                                                                                  |                                                                                                                                                                                                                                                                                                                                                                                                                         |
| debug.mode                                                                | enum('on')                                | on                                                                                     | deprecated                                                                                                                                                                                                                                                                                                                                                                                                              |
| debug.ip_addresses                                                        | array                                     | 127.0.0.1                                                                              | deprecated                                                                                                                                                                                                                                                                                                                                                                                                              |
| data.touristic.origins                                                    | array                                     | List of pressmind MyContent ID's                                                       | A pressmind media object can store more than one touristic object. <br> if you need a touristic object from a defined origin, change this value.                                                                                                                                                                                                                                                                             |
| data.touristic.my_content_class_map                                       | array                                     | [192 => '\Custom\TouristicImport']                                                     | In some cases you have to modify the media object during import.<br> If a defined MyContent data source is attached to the media object, the defined class will be executed. [More details](custom_import_hooks.md)                                                              |
| data.touristic.<br>media_type_custom_import_hooks                         | array                                     | [1001 => ['\Custom\TouristicImport']]                                                  | Same as above, but the custom class is trigger for each media object that matches the defined media object type. [More details](custom_import_hooks.md)                                                              |
| data.primary_media_type_ids                                               | array                                     | 607                                                                                    | Based on your media object model you have to define the primary object types id's here. This means that all secondary objects are only imported if they are linked to a primary object type.                                                                                                                                                                                                                         |
| data.media_types                                                          | array map                                 | [607 => 'Packages', 608 => 'Hotels']                                                   | Allowed media object types.                                                                                                                                                                                                                                                                                            |
| data.media_types_pretty_url.{OBJECT_TYPE_ID}.prefix                       | string                                    | /reise/                                                                                | See pretty url docu [here](pretty_url.md).                                                                                                                                                                                                                                                                                                                                                                                                   |
| data.media_types_pretty_url.{OBJECT_TYPE_ID}.separator                    | string                                    | separator for automatic url generation, eg. "-"                                                                                |                                                                                                                                                                                                                                                                                                                                                                                                                         |
| data.media_types_pretty_url.{OBJECT_TYPE_ID}.fields[].{VALUE}             | string                                    | configures the url generation,  possible values: id, code, name or generic field pattern {varname_section}, eg. headline_default                                                                                  |                                                                                                                                                                                                                                                                                                                                                                                                                         |
| data.media_types_pretty_url.{OBJECT_TYPE_ID}.strategy                     | enum(unique, count-up, none)                | none                                                                                   |                                                                                                                                                                                                                                                                                                                                                                                                                         |
| data.media_types_pretty_url.{OBJECT_TYPE_ID}.suffix                       | string                                    | /                                                                                      |                                                                                                                                                                                                                                                                                                                                                                                                                         |
| data.media_types_fulltext_index_fields.{OBJECT_TYPE_ID}                   | array                                     | ['title_default', 'headline_webtext','description_default']                            | This fieldmap defines the searchable fields for the fulltext search index. during installation all existing fields are set. <br> After change this array you have to rebuild the index, run "php fulltext_indexer.php" on commandline.                                                                                                                                                                  |
| data.sections.allowed                                                     | array                                     | ['Default']                                                                            | Defines which field sections should be imported in the current web-core installation                                                                                                                                                                                                                                                                                                                                         |
| data.sections.default                                                     | string                                    | Default                                                                                | Defines the default section which is in all media objects data properties available                                                                                                                                                                                                                                                                                                                                   |
| data.sections.fallback                                                    | string                                    | Default                                                                                | If the desired section is empty you can define a fallback section. This is useful for multilanguage systems, so if a translation is missing you can define you're fallback language.                                                                                                                                                                                                                                                  |
| data.sections.fallback_on_empty_values                                    | boolean                                   | true                                                                                   |                                                                                                                                                                                                                                                                                                                                                                                                                         |
| data.sections.replace.regular_expression                                  | string                                    | /_DE\|_EN\|_FR\|_NL/m                                                                  | In complex ENV you can rename the sectionnames by a defined regex. In this case all section names are stripped by the language codes. This is usefull to create a language neutral web-core setup.                                                                                                                                                                                                             |
| data.sections.replace.replacement                                         | string                                    | ''                                                                                     |                                                                                                                                                                                                                                                                                                                                                                                                                         |
| data.languages.allowed                                                    | array                                     | ['de', 'en']                                                                           |                                                                                                                                                                                                                                                                                                                                                                                                                         |
| data.languages.default                                                    | string                                    | de                                                                                     |                                                                                                                                                                                                                                                                                                                                                                                                                         |
| data.preview_url                                                          | string                                    | /examples/detail.php?id={{id_media_object}}&preview={{preview}}                        |                                                                                                                                                                                                                                                                                                                                                                                                                         |
| data.media_types_allowed_visibilities.{OBJECT_TYPE_ID}                    | array                                     | [30,10]                                                                                | Defines which visibilities for which media object type are allowed.                                                                                                                                                                                                                                                                                                                                                      |
| cache.enabled                                                             | boolean                                   | true                                                                                   |                                                                                                                                                                                                                                                                                                                                                                                                                         |
| cache.adapter.name                                                        | enum(Redis)                               | Redis                                                                                  | At this moment only the redis adapter is available                                                                                                                                                                                                                                                                                                                                                                      |
| cache.adapter.config.host                                                 | string                                    | 127.0.0.1                                                                              |                                                                                                                                                                                                                                                                                                                                                                                                                         |
| cache.adapter.config.port                                                 | int                                       | 6379                                                                                   |                                                                                                                                                                                                                                                                                                                                                                                                                         |
| cache.adapter.config.connection_string                                    | string                                    |                                                                                        | Custom redis connection string for bigger ENVs                                                                                                                                                                                                                                                                                                                                                                  |
| cache.key_prefix                                                          | string                                    | pm-web-core                                                                            | Adds a prefix for each key, useful if you have multiple systems on one redis database                                                                                                                                                                                                                                                                                                                                |
| cache.disable_parameter.key                                               | string                                    | no_cache                                                                               | _GET Parameter to disable the cache example: your-domain.de/trip/italy-for-divers/?no_cache=1 will deliver the uncached result                                                                                                                                                                                                                                                                                     |
| cache.disable_parameter.value                                             | string                                    | 1                                                                                      |                                                                                                                                                                                                                                                                                                                                                                                                                         |
| cache.update_parameter.key                                                | string                                    | update_cache                                                                           | _GET Parameter to disable the cache example: your-domain.de/trip/italy-for-divers/?update_cache=1 will update the cache und delivers the cached result                                                                                                                                                                                                                                                             |
| cache.update_parameter.value                                              | string                                    | 1                                                                                      |                                                                                                                                                                                                                                                                                                                                                                                                                         |
| cache.types.0                                                             | array                                     | ['REST','SEARCH','OBJECT']                                                             | The're are several caching layers included: <br>REST: caching layer for all REST-request on the REST-endpoint. <br>SEARCH: caching layer for search queries.  <br>OBJECT: caching layer for media objects                                                                                                                                                                                                                        |
| cache.update_frequency                                                    | int                                       | 3600                                                                                   | All cached keys are updated in the background in this frequency (cron.php has to be set up as crontab) unit: seconds                                                                                                                                                                                                                                                                                                  |
| cache.max_idle_time                                                       | int                                       | 86400                                                                                  | If the key is not used for this amount of time it will be deleted from cache                                                                                                                                                                                                                                                                                                                                         |
| view_scripts.base_path                                                    | dir                                       | APPLICATION_PATH/template-parts/pm-views                                               |                                                                                                                                                                                                                                                                                                                                                                                                                         |
| scaffolder_templates.overwrite_existing_templates                         | boolean                                   | false                                                                                  | Scaffolder templates are templates which building custom media object views during installation.. very but only useful if you plan to repack you're application for multiple installations                                                                                                                                                                                                                      |
| scaffolder_templates.base_path                                            | dir                                       | APPLICATION_PATH/template-parts/pm-views/scaffolder                                    |                                                                                                                                                                                                                                                                                                                                                                                                                         |
| file_handling.storage.provider                                            | enum(filesystem, s3)                      | filesystem                                                                             |                                                                                                                                                                                                                                                                                                                                                                                                                         |
| file_handling.storage.bucket                                              | string                                    | WEBSERVER_DOCUMENT_ROOT/downloads                                                      | If provider is 'filesystem' a absolute dirpath is required. if the provider is 's3' the bucketname is required.                                                                                                                                                                                                                                                                                                            |
| file_handling.storage.region                                              | string                                    | eu-central-1                                                                           | only required if provider is 's3'                                                                                                                                                                                                                                                                                                                                                                                       |
| file_handling.storage.version                                             | string                                    | latest                                                                                 | "                                                                                                                                                                                                                                                                                                                                                                                      |
| file_handling.storage.credentials.key                                     | string                                    | xxx                                                                                    | "                                                                                                                                                                                                                                                                                                                                                                                   |
| file_handling.storage.credentials.secret                                  | string                                    | yyy                                                                                    | "                                                                                                                                                                                                                                                                                                                                                                                     |
| file_handling.http_src                                                    | string                                    | WEBSERVER_HTTP/downloads or https://XXXX.cloudfront.net                                | Public http path to the assets (at this point you can setup a transparent CDN like cloudfrount)                                                                                                                                                                                                                                                                                                                       |
| image_handling.processor.adapter                                          | enum(ImageMagick, ImageMagickCLI, GD)     | ImageMagick                                                                          | See [image documentation](image_handling.md) for detail in image handling. <br> Recommend: ImageMagick (php exentension ext-imagick required)                                                                                                                                                                                                                                                                                                   |
| image_handling.processor.webp_support                                     | boolean                                   | true                                                                                   | Create a webp variant if true. Webp are create by php method "imagewebp()" requires (PHP 5 >= 5.4.0, PHP 7, PHP 8)                                                                                                                                                                                                                                                                                                    |
| image_handling.processor.derivatives.{DERIVATENAME}.max_width             | int                                       | 125                                                                                    |                                                                                                                                                                                                                                                                                                                                                                                                                         |
| image_handling.processor.derivatives.{DERIVATENAME}.max_height            | int                                       | 83                                                                                     |                                                                                                                                                                                                                                                                                                                                                                                                                         |
| image_handling.processor.derivatives.{DERIVATENAME}.preserve_aspect_ratio | boolean                                   | false                                                                                  |                                                                                                                                                                                                                                                                                                                                                                                                                         |
| image_handling.processor.derivatives.{DERIVATENAME}.crop                  | boolean                                   | true                                                                                   |                                                                                                                                                                                                                                                                                                                                                                                                                         |
| image_handling.processor.derivatives.{DERIVATENAME}.horizontal_crop       | enum                                      | center                                                                                 | see imagemagicks [-gravity option](https://imagemagick.org/script/command-line-options.php#gravity)                                                                                                                                                                                                                                                                                                                      |
| image_handling.processor.derivatives.{DERIVATENAME}.vertical_crop         | enum                                      | center                                                                                 | "                                                                                                                                                                                                                                                                                                                                                                                       |
| image_handling.processor.derivatives.{DERIVATENAME}.webp_create           | boolean                                   | true                                                                                   | create a webp variant for this derivate                                                                                                                                                                                                                                                                                                                                                                                 |
| image_handling.processor.derivatives.{DERIVATENAME}.webp_quality          | int                                       | 80                                                                                     |                                                                                                                                                                                                                                                                                                                                                                                                                         |
| image_handling.storage.provider                                           | enum(filesystem, s3)                      | filesystem                                                                             |                                                                                                                                                                                                                                                                                                                                                                                                                         |
| image_handling.storage.bucket                                             | string                                    | WEBSERVER_DOCUMENT_ROOT/images                                                         | If provider is 'filesystem' a absolute dirpath is required. if the provider is 's3' the bucketname is required.                                                                                                                                                                                                                                                                                                          |
| image_handling.storage.region                                             | string                                    | eu-central-1                                                                           | only required if provider is 's3'                                                                                                                                                                                                                                                                                                                                                                                       |
| image_handling.storage.version                                            | string                                    | latest                                                                                 | "                                                                                                                                                                                                                                                                                                                                                                                      |
| image_handling.storage.credentials.key                                    | string                                    | xxx                                                                                    | "                                                                                                                                                                                                                                                                                                                                                                                      |
| image_handling.storage.credentials.secret                                 | string                                    | yyy                                                                                    | "                                                                                                                                                                                                                                                                                                                                                                                 |
| image_handling.http_src                                                   | string                                    | WEBSERVER_HTTP/images or https://XXXX.cloudfront.net                                   | Public http path to the images (at this point you can setup a transparent CDN like cloudfrount)                                                                                                                                                                                                                                                                                                                       |
| scheduled_tasks.0.name                                                    | string                                    | Log Clean Up                                                                           | Scheduled tasks are triggered by cron.php. Please ensure that you have configured the crontab for cron.php                                                                                                                                                                                                                                                                                                             |
| scheduled_tasks.0.class_name                                              | class                                     | \Pressmind\Log\Service                                                                 | Class with namespace                                                                                                                                                                                                                                                                                                                                                                                                 |
| scheduled_tasks.0.schedule.type                                           | enum(Daily, Minutely)                     | Daily                                                                                  |                                                                                                                                                                                                                                                                                                                                                                                                                         |
| scheduled_tasks.0.schedule.time                                           | enum(Fixed, Period)                       | Fixed                                                                                  |                                                                                                                                                                                                                                                                                                                                                                                                                         |
| scheduled_tasks.0.schedule.value                                          | string H:i                                | 23:30                                                                                  |                                                                                                                                                                                                                                                                                                                                                                                                                         |
| scheduled_tasks.0.methods.0.method                                        | string                                    | cleanUp                                                                                | Function in given class                                                                                                                                                                                                                                                                                                                                                                                                 |
| scheduled_tasks.0.methods.0.parameters                                    | array                                     |                                                                                        | Parameters for the given function                                                                                                                                                                                                                                                                                                                                                                                        |
| scheduled_tasks.0.methods.0.position                                      | int                                       | 1                                                                                      | run order                                                                                                                                                                                                                                                                                                                                                                                                               |
| scheduled_tasks.1.name                                                    | string                                    | Cache Clean Up                                                                         |                                                                                                                                                                                                                                                                                                                                                                                                                         |
| scheduled_tasks.1.class_name                                              | class                                     | \Pressmind\Cache\Service                                                               |                                                                                                                                                                                                                                                                                                                                                                                                                         |
| scheduled_tasks.1.schedule.type                                           | enum(Daily, Minutely)                     | Minutely                                                                               |                                                                                                                                                                                                                                                                                                                                                                                                                         |
| scheduled_tasks.1.schedule.time                                           | enum(Fixed, Period)                       | Period                                                                                 |                                                                                                                                                                                                                                                                                                                                                                                                                         |
| scheduled_tasks.1.schedule.value                                          | string H:i                                | 5                                                                                      |                                                                                                                                                                                                                                                                                                                                                                                                                         |
| scheduled_tasks.1.methods.0.method                                        | string                                    | cleanUp                                                                                |                                                                                                                                                                                                                                                                                                                                                                                                                         |
| scheduled_tasks.1.methods.0.parameters                                    | array                                     |                                                                                        |                                                                                                                                                                                                                                                                                                                                                                                                                         |
| scheduled_tasks.1.methods.0.position                                      | int                                       | 1                                                                                      |                                                                                                                                                                                                                                                                                                                                                                                                                         |

## FAQ

### Nothing will happen after changing the property "media_types_pretty_url".
After changing these values, you have to rebuild your routes.
run "php rebuild_routes.php" on commandline

### Nothing will happen after changing the property "media_types_fulltext_index_fields".
After changing these values, you have to rebuild your routes.
run "php fulltext_indexer.php" commandline
